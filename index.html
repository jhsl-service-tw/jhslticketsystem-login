<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æˆ‘å€‘çš„è²“å’ªæœˆæ›†</title>
    <style>
        :root {
            --orange-main: #ffb366;
            --heart-red: #ff4d4d;
            --bg-color: #fdfaf7;
        }
        body { font-family: sans-serif; margin: 0; background: var(--bg-color); color: #444; }
        
        /* ç™»å…¥ç•«é¢ */
        #login-screen { position: fixed; inset: 0; background: white; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; }
        #app { display: none; padding: 10px; max-width: 500px; margin: auto; }

        /* æœˆæ›†æ¨™é¡Œèˆ‡åˆ‡æ› */
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .btn-nav { background: var(--orange-main); border: none; color: white; padding: 8px 15px; border-radius: 20px; font-weight: bold; }

        /* æœˆæ›†ç¶²æ ¼ */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; background: white; padding: 10px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .weekday { text-align: center; font-size: 0.8rem; font-weight: bold; color: #888; padding: 5px 0; }
        .day-cell { min-height: 60px; border-radius: 10px; border: 1px solid #f0f0f0; position: relative; padding: 5px; transition: 0.2s; }
        .day-cell.today { border: 2px solid var(--orange-main); background: #fff9f2; }
        .day-num { font-weight: bold; font-size: 14px; }
        
        /* æ„›å¿ƒæ¨£å¼ */
        .heart-icon { position: absolute; bottom: 2px; right: 2px; font-size: 12px; color: #ffcccc; transition: 0.3s; }
        .heart-icon.active { color: var(--heart-red); transform: scale(1.5); }

        /* è¡Œç¨‹è¼¸å…¥å€åŸŸ (é»æ“Šæ—¥æœŸå¾Œé¡¯ç¤º) */
        #details-panel { margin-top: 20px; background: white; border-radius: 20px; padding: 20px; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); }
        .task-input { width: 100%; border: none; border-bottom: 1px solid #eee; padding: 12px 0; font-size: 16px; margin-bottom: 10px; outline: none; }
    </style>
</head>
<body>

<div id="login-screen">
    <h2>ğŸ¾ è²“å’ªç§˜å¯†é€šé“</h2>
    <input type="password" id="pwd" placeholder="è¼¸å…¥å¯†ç¢¼" style="padding:12px; border-radius:10px; border:1px solid #ddd; text-align:center;">
    <button onclick="checkLogin()" style="margin-top:15px; padding:10px 30px; background:var(--orange-main); border:none; border-radius:20px; color:white; font-weight:bold;">é–‹å•Ÿ</button>
</div>

<div id="app">
    <div class="calendar-header">
        <button class="btn-nav" onclick="changeMonth(-1)">â—€</button>
        <h2 id="current-month-display">2026å¹´ 1æœˆ</h2>
        <button class="btn-nav" onclick="changeMonth(1)">â–¶</button>
    </div>

    <div class="calendar-grid" id="calendar-grid">
        <div class="weekday">æ—¥</div><div class="weekday">ä¸€</div><div class="weekday">äºŒ</div>
        <div class="weekday">ä¸‰</div><div class="weekday">å››</div><div class="weekday">äº”</div><div class="weekday">å…­</div>
    </div>

    <div id="details-panel" style="display:none;">
        <h3 id="selected-date-label" style="margin-top:0;">é¸æ“‡æ—¥æœŸ</h3>
        <input type="text" class="task-input" id="t1" placeholder="è¡Œç¨‹ 1..." onchange="updateData()">
        <input type="text" class="task-input" id="t2" placeholder="è¡Œç¨‹ 2..." onchange="updateData()">
        <input type="text" class="task-input" id="t3" placeholder="è¡Œç¨‹ 3..." onchange="updateData()">
        <button onclick="toggleHeartInDetail()" id="detail-heart-btn" style="background:none; border:none; font-size:24px; cursor:pointer;">ğŸ¤</button>
    </div>
</div>

<script>
    let currentViewDate = new Date();
    let selectedDateStr = "";

    function checkLogin() {
        if(document.getElementById('pwd').value === '20190927') {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            renderCalendar();
        } else { alert('å¯†ç¢¼éŒ¯å›‰ï¼'); }
    }

    function renderCalendar() {
        const grid = document.getElementById('calendar-grid');
        // æ¸…é™¤èˆŠæ—¥æœŸï¼ˆä¿ç•™æ˜ŸæœŸæ¨™ç±¤ï¼‰
        const weekdays = grid.querySelectorAll('.weekday');
        grid.innerHTML = "";
        weekdays.forEach(w => grid.appendChild(w));

        const year = currentViewDate.getFullYear();
        const month = currentViewDate.getMonth();
        document.getElementById('current-month-display').innerText = `${year}å¹´ ${month + 1}æœˆ`;

        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        // å¡«å……ç©ºç™½
        for(let i=0; i<firstDay; i++) {
            grid.appendChild(document.createElement('div'));
        }

        // å¡«å……æ—¥æœŸ
        for(let d=1; d<=daysInMonth; d++) {
            const dateStr = `${year}-${month+1}-${d}`;
            const cell = document.createElement('div');
            cell.className = 'day-cell';
            if(new Date().toDateString() === new Date(year, month, d).toDateString()) cell.classList.add('today');
            
            const data = JSON.parse(localStorage.getItem(dateStr) || '{"tasks":["","",""], "heart":false}');
            
            cell.innerHTML = `
                <div class="day-num">${d}</div>
                <div class="heart-icon ${data.heart ? 'active' : ''}">â¤</div>
            `;
            cell.onclick = () => showDetails(dateStr);
            grid.appendChild(cell);
        }
    }

    function showDetails(dateStr) {
        selectedDateStr = dateStr;
        document.getElementById('details-panel').style.display = 'block';
        document.getElementById('selected-date-label').innerText = dateStr;
        
        const data = JSON.parse(localStorage.getItem(dateStr) || '{"tasks":["","",""], "heart":false}');
        document.getElementById('t1').value = data.tasks[0];
        document.getElementById('t2').value = data.tasks[1];
        document.getElementById('t3').value = data.tasks[2];
        document.getElementById('detail-heart-btn').innerText = data.heart ? 'â¤ï¸' : 'ğŸ¤';
        
        // æ»¾å‹•åˆ°ä¸‹æ–¹ç·¨è¼¯å€
        document.getElementById('details-panel').scrollIntoView({behavior: "smooth"});
    }

    function updateData() {
        const data = {
            tasks: [document.getElementById('t1').value, document.getElementById('t2').value, document.getElementById('t3').value],
            heart: document.getElementById('detail-heart-btn').innerText === 'â¤ï¸'
        };
        localStorage.setItem(selectedDateStr, JSON.stringify(data));
        renderCalendar();
    }

    function toggleHeartInDetail() {
        const btn = document.getElementById('detail-heart-btn');
        btn.innerText = (btn.innerText === 'ğŸ¤') ? 'â¤ï¸' : 'ğŸ¤';
        updateData();
    }

    function changeMonth(diff) {
        currentViewDate.setMonth(currentViewDate.getMonth() + diff);
        renderCalendar();
    }
</script>
</body>
</html>
